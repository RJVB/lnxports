# -*- coding: utf-8; mode: tcl; c-basic-offset: 4; indent-tabs-mode: nil; tab-width: 4; truncate-lines: t -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4

PortSystem      1.0
PortGroup       cmake 1.1
PortGroup       github 1.0
set LTO.allow_ThinLTO no
PortGroup       LTO 1.0
PortGroup       devport 1.0

github.setup    apple swift-corelibs-libdispatch 4bf826d25b5f9fad73f6311daf6a2f5ab29d9106
    name        libdispatch-devel
    version     22.8.24 ; revision 2
    distname    libdispatch-git
    fetch.type  git
    conflicts   libdispatch

categories      sysutils
platforms       linux
license         Apache-2
maintainers     gmail.com:rjvbertin openmaintainer
description     The libdispatch Project, (a.k.a. Grand Central Dispatch), for concurrency on multicore hardware
long_description \
                Grand Central Dispatch (GCD or libdispatch) provides comprehensive support \
                for concurrent code execution on multicore hardware.

####################
    create_devport ${name}

    if {${subport} eq "${name}-devel-dev"} {
        conflicts-append \
                libdispatch-dev
        # we don't care about anything that follows,
        # return here to avoid having to add more subport checks.
        return
    }
####################

configure.args-append \
                -DINSTALL_PRIVATE_HEADERS=ON \
                -DCMAKE_STRIP:PATH=/bin/echo

cmake.save_configure_cmd "install log"

post-destroot {
    if {[info procs create_devport_content_archive] ne ""} {
        register_devport_standard_content
        create_devport_content_archive
    }
}

test.run		yes

